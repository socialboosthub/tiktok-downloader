<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Slider Downloader</title>
  <style>
    body { font-family: Arial; text-align: center; }
    img { max-width: 100%; border-radius: 12px; }
    .avatar { width: 80px; border-radius: 50%; }
    button { padding: 12px 20px; font-size: 16px; }
  </style>
</head>
<body>

<h2>ðŸ“¸ TikTok Slider Downloader</h2>

<input id="url" placeholder="Paste TikTok link" style="width:90%" />
<br><br>
<button onclick="load()">Fetch</button>

<div id="result"></div>

<script>
async function load() {
  const url = document.getElementById("url").value;
  const res = await fetch(`/api?url=${encodeURIComponent(url)}`);
  const j = await res.json();

  const d = j.data;
  if (!d.images) {
    alert("Not a slider post");
    return;
  }

  const avatar = d.author?.avatar || "/default-avatar.png";
  const name = d.author?.unique_id || "unknown";

  const btnText =
    d.images.length === 1
      ? "Download Photo"
      : "Download All Photos";

  document.getElementById("result").innerHTML = `
    <img class="avatar" src="${avatar}">
    <p>@${name}</p>
    <img src="${d.images[0]}">
    <br><br>
    <button onclick="download()"> ${btnText} </button>
  `;

  window.download = () => {
    if (d.images.length === 1) {
      location.href =
        d.images[0];
    } else {
      location.href =
        \`/slider-zip?images=\${encodeURIComponent(
          JSON.stringify(d.images)
        )}&name=\${name}\`;
    }
  };
}
</script>

</body>
</html>
