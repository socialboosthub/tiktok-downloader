<!DOCTYPE html>
<html>
<head>
  <title>Download Video</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="text-align:center;font-family:sans-serif">

<h3>Your Video</h3>

<img id="thumb"
     src=""
     style="width:95%;border-radius:12px"
     alt="Thumbnail">

<br><br>

<button id="btn" style="padding:12px 25px;font-size:16px">
Download Video
</button>

<script>
const params = new URLSearchParams(window.location.search);
const tiktokUrl = params.get("url");

async function load() {
  const res = await fetch(`/api?url=${encodeURIComponent(tiktokUrl)}`);
  const json = await res.json();

  // USE COVER ONLY (NOT PLAY)
  document.getElementById("thumb").src =
    json.data.cover || json.data.origin_cover;

  const videoUrl = json.data.play;

  document.getElementById("btn").onclick = () => {
    window.location.href =
      `/download?url=${encodeURIComponent(videoUrl)}`;
  };
}

load();
</script>

</body>
</html>
